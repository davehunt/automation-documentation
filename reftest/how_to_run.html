<html>
  <head>
    <link rel="stylesheet" href="http://developer.mozilla.org/media/css/mdn-min.css?build=919eaca" />
    <link rel="stylesheet" href="http://developer.mozilla.org/media/css/wiki-min.css?build=919eaca" />
  </head>
  <body>
    <section id="content">
      <div class="wrap">
        <div id="content-main" class="full">
          <article class="article">
            <header id="article-head">
              <div class="title">
                <h1 class="page-title">Running Reftests</h1>
              </div>
            </header>

            <div id="wikiArticle" class="page-content boxed">
              <h2>Read first</h2>
              <ul>
                <li><a href="overview.html">Reftest overview</a></li>
              </ul>

              <h2>Desktop</h2>

              <h3>Running on try</h3>
              <p>To run the reftests on try, add the following <code>try:</code> block to the end of the topmost commit message when you push to try.</p>
              <pre>try: -b do -u reftest</pre>
              <p>For more information, read the <a href="https://wiki.mozilla.org/Build:TryChooser">TryChooser documentation</a>.</p>

              <h3>Running with build environment</h3>
              <p>First, setup a <a href="https://developer.mozilla.org/en-US/docs/Simple_Firefox_build">Firefox build environment</a>. In the following examples, <code>$(OBJDIR)</code> is the build's object directory. This is prefixed with obj-, and the exact name depends on your system and OS.</p>

              <h4>Run all tests</h4>
              <pre class="brush:html">$ make -C $(OBJDIR) reftest</pre>

              <h4>Run a subset of tests</h4>
              <pre class="brush:html">$ TEST_PATH=path/from/sourcedir/reftest.list make -C $(OBJDIR) reftest</pre>

              <h4>Run IPC reftests</h4>
              <p>Reftests can also be run in a separate process, which can differ from same-process rendering in significant ways. Currently, IPC reftests are only being run on Linux.</p>
              <pre class="brush:html">$ MOZ_LAYERS_FORCE_SHMEM_SURFACES=1 make -C $(OBJDIR) reftest-ipc</pre>

              <div class="note">Automation currently only runs <code>layout/reftests/reftest-sanity/reftest.list</code>! If you try to run the full suite, you may experience stalls or other issues.</div>

              <h3>Running with built packages</h3>
              <p>First, download and extract the <a href="../built_test_packages.html#Firefox">built test packages</a>. The following commands require the extracted <code>tests/reftest</code> as the working directory.</p>

              <h4>Run all tests</h4>
              <pre class="brush:html">$ python runreftest.py tests/layout/reftests</pre>

              <h4>Run sanity tests</h4>
              <pre class="brush:html">$ python runreftest.py tests/layout/reftests/reftest-sanity</pre>

              <h2>Mobile</h2>
              <p>Reftest does not support running tests on mobile.</p>

              <h2>Continue reading</h2>
              <a href="how_to_write.html">How to write Reftests</a>
            </div>

            <section class="page-meta">
              <section id="page-tags">
                <div id="deki-page-tags">
                  <ul class="tagit ui-widget">
                    <li class="tagit-choice">
                      <a class="tagit-label">Automation</a>
                    </li>
                    <li class="tagit-choice">
                      <a class="tagit-label">Reftests</a>
                    </li>
                  </ul>
                </div>
              </section>
            </section>
          </article>
        </div>
      </div>
    </section>
  </body>
</html>